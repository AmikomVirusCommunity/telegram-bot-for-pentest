#!/usr/bin/env python
#
# Small stuff bot for pentest
# A library that provides Pentest with Telegram bot
# Nanda Reynaldi <nandareynaldi97@gmail.com>
# GOOGLE DORKING MODULE FOR PENTEST BOOT

import requests, re
from bs4 import BeautifulSoup
import sys
url = 'http://www.google.co.id/search'
if isinstance(sys.argv[1], int) != False:
    print("Command page must be integer")
else:
    payload = { 'q' : sys.argv[2], 'start' : sys.argv[1] } #get arguments and set payload
    my_headers = { 'User-agent' : 'Mozilla/11.0' }
    r = requests.get( url, params = payload, headers = my_headers )
    soup = BeautifulSoup( r.text, 'html.parser' )
    h3tags = soup.find_all( 'h3', class_='r' )
    for h3 in h3tags:
        try:
            print( re.search('url\?q=(.+?)\&sa', h3.a['href']).group(1) )
        except:
            continue